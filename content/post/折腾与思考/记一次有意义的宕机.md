---
title: 记一次有意义的宕机
description: 
image: 
date: 2016-03-15 20:00:16
categories: 折腾与思考
url: /post/3488
---

![](https://cdn.victor42.work/posts/2016-03/03-15/cover.png)

或许有朋友注意到了，我的博客昨晚宕机了。从下午5点左右开始，博客里只剩下几篇很老的文章，再后来就彻底打不开了，一直持续到第二天凌晨3点左右才恢复。对于我这样一个个人网站而言，这种程度的故障其实没什么大不了的，真的不值得大惊小怪。

背后的原因呢，其实就是我“手贱”，但整个过程还挺波折，很值得一说。

起初，是我使用的markdown编辑器MarkEditor发布了新版本，认真看了软件官网的介绍视频，才发现原来近半年的几次版本更新中，我错过了许多新功能。关于MarkEditor，我之后会专门写一篇文章来介绍（没错，那会是一篇来自真实用户的广告文），在此就不深入了。反正有提醒就更新嘛，更新完了还是按照以前的习惯用，也不知道更新了些什么，谁不是呢？作为设计师与产品人，自己必须长期不懈压制这种本能，但同时又万万不能忘记它的存在，多么矛盾的处境。

好了，新版本上手了，各种新功能一个个试过来。除了从各方面提高写作效率之外，还能把整个写作文件夹同步到第三方云服务商，整体刷新了我对这款软件的认识。它诞生之初，[软件作者](http://weibo.com/farbox)就邀请我试用过。作为Farbox客户端的同门师弟，当时MarkEditor给我的感觉，像是把Farbox的写作部分抽离出来，成为一个脱离博客系统独立存在的写作工具，是一个子集。现在看来，则是完全超越且意在取而代之的存在。

探索的过程很有趣，有大量的Aha moment，一边学着使用这些新功能，一边思考如果要享受这些便利，自己的写作方式需要做哪些调整。既然开始想了，就会一发不可收拾，马上开始着手改变和优化自己的写作流程。举个例子，你肯定无法想象我之前文章插图的方法有多原始，我会把图片按年月日分目录放，再把这个目录结构搬到七牛云上。这应该是以前用wordpress留下的习惯，虽然麻烦，但有它的好处。自己租空间搭建wordpress网站的时候，一来方便用FTP管理，再就是大大减少图片重名导致的麻烦。

![](https://cdn.victor42.work/posts/2016-03/03-15/03-11.png)

然而七牛云上要实现同样的目录结构，则是靠手工添加前缀。它也有自己的图形化上传工具，不过一直懒于研究。所以就长期这么蠢蠢地手动填日期前缀、上传图片，再一张张复制url贴回文章里。

![](https://cdn.victor42.work/posts/2016-03/03-15/七牛云_-_内容管理.png)

新版的MarkEditor开始支持同步到第三方云服务商，而且是像Git那样，整个写作目录原封不动同步过去，增删改不用再去云端管理了。我要做的，就是在写作目录里准备好图片的目录结构，把文章插图集中整理。写作时，复制图片的云端地址插入文章中，发布前整体同步一下就好。这么一对比，以前的插图方式简直不能忍啊！

![](https://cdn.victor42.work/posts/2016-03/03-15/全屏幕16_3_15_18_07.png)

我把之前所有的文章插图都搬到博客目录里来了，一下子来了4000多张图片。dropbox开始同步了（我的Farbox是用dropbox同步的），估计要进行好一阵子。然后忽然觉得目录结构不该这么安排，应该多设一层以备将来有其他用途。所以又建了个文件夹，把图片目录整个移了进去。但仔细想想还是不对，如果是其他用途，为什么还要放到毫不相干的博客系统里来呢？应该把写作和发布博客当作两件事来看待，写作和插图的目录应该放到博客目录外面去。于是4000多个文件又被我移走了。

一来二去，dropbox和Farbox之间的同步机制抓狂了。出现了一个BUG，导致博客指向了我调试用的测试站点，所以大家只看到几篇很老的文章。而测试站点则变成了一个空站点，什么也没有。

这是个大问题啊，我得马上解决。先把测试站点整个删除试试，发现不管用，dropbox的同步还在进行，估计添加文件的那一次同步都还没完成。我这么一极端操作，不知道导致了什么冲突结果。那一不做二不休，只能删彻底一点，把我的主站也删了，再迅速重新搭建一遍。所以你会看到我的网站彻底打不开了，同时我也发现Farbox账号下还有一个无名字的空站点，怎么删都删不掉。很显然，这就是那个正在同步的家伙，看来彻底被我玩坏了。

只好求助Farbox作者，他建议我借此机会换个方式，用Farbox自己的服务器来半自动同步，把dropbox的同步从账户里去掉，解除授权。全自动的同步虽然方便，但可控性差，出了问题难以迅速响应解决，就像这次一样。

是啊，一味追求便捷流畅的我们，有没有站在这个角度考虑过呢？回到正题，现在把Farbox和dropbox两边的同步绑定都解除，重新搭建站点，用编辑器里的同步功能来同步。问题到这里其实已经解决了，不过我大半个晚上都在做实验。把文件往里面加了又删，删了又加，一次次反复同步，观察同步记录。这才完全理解整个同步的过程，还有博客和编辑器之间的关系。

多亏这次手贱宕机，让我有机会重新思考自己的写作方式，重新认识自己日夜使用的写作工具。就像小时候学电脑一样，被我弄坏过无数次，找人来修，修好又被弄坏。然后……我才成了大学里的维修队长 →_→

破坏与重建，也是一种理解事物的方式。草原上的一道天雷，卷起漫天大火，然后万物重获新生。